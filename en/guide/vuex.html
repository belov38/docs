<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Persisting state | vuesion</title>
    <meta name="description" content="The most complete boilerplate for production-ready PWAs. With focus on performance, development speed, and best practices">
    <link rel="icon" href="/docs/logo.png">
  <link rel="manifest" href="/docs/manifest.json">
  <meta name="theme-color" content="#f43b6c">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/docs/icons/apple-touch-icon-152x152.png">
  <link rel="mask-icon" href="/docs/icons/safari-pinned-tab.svg" color="#f43b6c">
  <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
  <meta name="msapplication-TileColor" content="#f43b6c">
    
    <link rel="preload" href="/docs/assets/css/0.styles.131071a3.css" as="style"><link rel="preload" href="/docs/assets/js/app.1d2a10be.js" as="script"><link rel="preload" href="/docs/assets/js/2.bed876bd.js" as="script"><link rel="preload" href="/docs/assets/js/23.1675ef9e.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.0ce8ddde.js"><link rel="prefetch" href="/docs/assets/js/11.586eaf50.js"><link rel="prefetch" href="/docs/assets/js/12.f6234c7e.js"><link rel="prefetch" href="/docs/assets/js/13.9979d621.js"><link rel="prefetch" href="/docs/assets/js/14.67424a41.js"><link rel="prefetch" href="/docs/assets/js/15.eee4e3d4.js"><link rel="prefetch" href="/docs/assets/js/16.c776fbc3.js"><link rel="prefetch" href="/docs/assets/js/17.aa47d843.js"><link rel="prefetch" href="/docs/assets/js/18.11157a14.js"><link rel="prefetch" href="/docs/assets/js/19.eed3eb84.js"><link rel="prefetch" href="/docs/assets/js/20.c45fb1ee.js"><link rel="prefetch" href="/docs/assets/js/21.f54f2fbd.js"><link rel="prefetch" href="/docs/assets/js/22.ba05bb75.js"><link rel="prefetch" href="/docs/assets/js/24.fbe392b6.js"><link rel="prefetch" href="/docs/assets/js/25.82a9959d.js"><link rel="prefetch" href="/docs/assets/js/26.df6f5248.js"><link rel="prefetch" href="/docs/assets/js/27.b2491dfa.js"><link rel="prefetch" href="/docs/assets/js/28.d5f1c5ab.js"><link rel="prefetch" href="/docs/assets/js/29.79db8cd0.js"><link rel="prefetch" href="/docs/assets/js/3.a380f024.js"><link rel="prefetch" href="/docs/assets/js/30.58d26f51.js"><link rel="prefetch" href="/docs/assets/js/31.9038debc.js"><link rel="prefetch" href="/docs/assets/js/32.9d9e99af.js"><link rel="prefetch" href="/docs/assets/js/33.b912aa2e.js"><link rel="prefetch" href="/docs/assets/js/34.dca97d7b.js"><link rel="prefetch" href="/docs/assets/js/35.3ece796b.js"><link rel="prefetch" href="/docs/assets/js/36.cdddfbee.js"><link rel="prefetch" href="/docs/assets/js/37.58f9c393.js"><link rel="prefetch" href="/docs/assets/js/38.41fa58d2.js"><link rel="prefetch" href="/docs/assets/js/39.41ff603f.js"><link rel="prefetch" href="/docs/assets/js/4.7bf71852.js"><link rel="prefetch" href="/docs/assets/js/40.83b0add2.js"><link rel="prefetch" href="/docs/assets/js/41.1b8df377.js"><link rel="prefetch" href="/docs/assets/js/42.a991f4d9.js"><link rel="prefetch" href="/docs/assets/js/43.d748f8d4.js"><link rel="prefetch" href="/docs/assets/js/44.750c9f08.js"><link rel="prefetch" href="/docs/assets/js/45.ce0b37e4.js"><link rel="prefetch" href="/docs/assets/js/46.59d3cdff.js"><link rel="prefetch" href="/docs/assets/js/5.f692d775.js"><link rel="prefetch" href="/docs/assets/js/6.66932f5c.js"><link rel="prefetch" href="/docs/assets/js/7.8e739349.js"><link rel="prefetch" href="/docs/assets/js/8.84538652.js"><link rel="prefetch" href="/docs/assets/js/9.ae7b9273.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.131071a3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/en/" class="home-link router-link-active"><!----> <span class="site-name">vuesion</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/en/FAQ.html" class="nav-link">FAQ</a></div><div class="nav-item"><a href="/docs/en/introduction.html" class="nav-link">Guide</a></div><div class="nav-item"><a href="https://vuesion.herokuapp.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Interactive Demo
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://vuesion.herokuapp.com/storybook" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Components
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://discord.gg/59x5cg2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://slack-vuesion.herokuapp.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Slack
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">中文</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/en/guide/vuex.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/docs/zh-cn/guide/vuex.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/vuesion/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/en/FAQ.html" class="nav-link">FAQ</a></div><div class="nav-item"><a href="/docs/en/introduction.html" class="nav-link">Guide</a></div><div class="nav-item"><a href="https://vuesion.herokuapp.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Interactive Demo
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://vuesion.herokuapp.com/storybook" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Components
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://discord.gg/59x5cg2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://slack-vuesion.herokuapp.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Slack
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">中文</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/en/guide/vuex.html" class="nav-link router-link-exact-active router-link-active">English</a></li><li class="dropdown-item"><!----> <a href="/docs/zh-cn/guide/vuex.html" class="nav-link">简体中文</a></li></ul></div></div> <a href="https://github.com/vuesion/docs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Getting started</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/en/FAQ.html" class="sidebar-link">FAQ</a></li><li><a href="/docs/en/guide/install.html" class="sidebar-link">Installation</a></li><li><a href="/docs/en/guide/run.html" class="sidebar-link">Run the application</a></li><li><a href="/docs/en/guide/test.html" class="sidebar-link">Run the tests</a></li><li><a href="/docs/en/guide/clean-up.html" class="sidebar-link">Clean up</a></li><li><a href="/docs/en/guide/i18n.html" class="sidebar-link">I18n</a></li><li><a href="/docs/en/guide/cli.html" class="sidebar-link">Create a new Page</a></li><li><a href="/docs/en/guide/vuex.html" class="active sidebar-link">Persisting state</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/en/guide/vuex.html#persist-to-cookies" class="sidebar-link">Persist to cookies</a></li><li class="sidebar-sub-header"><a href="/docs/en/guide/vuex.html#persist-to-localstorage" class="sidebar-link">Persist to LocalStorage</a></li></ul></li><li><a href="/docs/en/guide/build.html" class="sidebar-link">Production build</a></li><li><a href="/docs/en/guide/config.html" class="sidebar-link">Config</a></li><li><a href="/docs/en/guide/contribute.html" class="sidebar-link">Support the project</a></li><li><a href="/docs/en/guide/update.html" class="sidebar-link">Stay up to date</a></li><li><a href="/docs/en/guide/deployment.html" class="sidebar-link">Deployment</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Tutorials</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/en/tutorials/redirects.html" class="sidebar-link">Redirect to another page</a></li><li><a href="/docs/en/tutorials/prefetch-and-state-transfer.html" class="sidebar-link">Prefetching data</a></li><li><a href="/docs/en/tutorials/third-party.html" class="sidebar-link">Use a 3rd party UI library</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Docs</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/en/docs/style-guide.html" class="sidebar-link">Style Guide</a></li><li><a href="/docs/en/docs/pwa.html" class="sidebar-link">Progressive-Web-App</a></li><li><a href="/docs/en/docs/npm-scripts.html" class="sidebar-link">NPM Scripts</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="persisting-state"><a href="#persisting-state" aria-hidden="true" class="header-anchor">#</a> Persisting state</h1> <p>By default, VueX keeps the state in memory. But the problem with keeping the state in memory is,
that the state is reset as soon as the user reloads the page.</p> <p>There are many ways to persist state if the user reloads the page,
for example, you could keep variables in the query of the URL and restore the state if the page loads.</p> <p>This approach is ok for a small amount of data that is not confidential, e.g. filters, sort directions, page number.</p> <p>But sometimes you have to store confidential data like access tokens or big data objects like a list of products.
In these cases, you need to store your data in cookies or LocalStorage.</p> <p>Vuesion comes with a VueX middleware that allows you to decide to persist VueX modules in different storages.</p> <h2 id="persist-to-cookies"><a href="#persist-to-cookies" aria-hidden="true" class="header-anchor">#</a> Persist to cookies</h2> <p>Vuesion includes a CookieStorage adapter for the VueX-persist middleware.</p> <div class="tip custom-block"><p class="custom-block-title">Cookies</p> <p><strong>Before you apply this tip, have a talk with a security engineer!</strong></p> <p>Cookies are good for keeping access tokens. Cookies are available on the server too.
This means you can connect to protected APIs on the server to render the initial page for the user
with the correct data.</p></div> <p>The CookieStorage adapter is already referenced in the file <code>./src/app/store.ts</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> PersistCookieStorage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vuesion/addon-vuex-persist/dist/PersistCookieStorage'</span><span class="token punctuation">;</span>

<span class="token operator">...</span>

<span class="token keyword">const</span> beforePersistCookieStorage <span class="token operator">=</span> <span class="token punctuation">(</span>localState<span class="token punctuation">:</span> IState<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token parameter">IState</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">delete</span> localState<span class="token punctuation">.</span>app<span class="token punctuation">.</span>config<span class="token punctuation">;</span>
  <span class="token keyword">delete</span> localState<span class="token punctuation">.</span>app<span class="token punctuation">.</span>defaultMessages<span class="token punctuation">;</span>
  <span class="token keyword">delete</span> localState<span class="token punctuation">.</span>app<span class="token punctuation">.</span>redirectTo<span class="token punctuation">;</span>

  <span class="token keyword">return</span> localState<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token operator">...</span>

          <span class="token keyword">new</span> <span class="token class-name">PersistCookieStorage</span><span class="token punctuation">(</span>
            <span class="token punctuation">[</span><span class="token string">'app'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              cookieOptions<span class="token punctuation">:</span> <span class="token punctuation">{</span>
                expires<span class="token punctuation">:</span> <span class="token number">365</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
              beforePersist<span class="token punctuation">:</span> beforePersistCookieStorage<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre></div><p>To persist your state to a cookie, you have to initialize a
new instance of <code>PersistCookieStorage</code> which takes a list of module names as
the first parameter and an <code>options</code> object as the second parameter.</p> <p>You can define the <code>cookieOptions</code>, which is a copy of the
<a href="https://github.com/js-cookie/js-cookie#cookie-attributes" target="_blank" rel="noopener noreferrer">js-cookie<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> attributes
and a callback to delete state that should not be persisted to the cookie.</p> <h3 id="extracting-cookie-state-on-the-server"><a href="#extracting-cookie-state-on-the-server" aria-hidden="true" class="header-anchor">#</a> Extracting cookie state on the server</h3> <p>The following part of <code>/src/server/isomorphic.ts</code> is responsible for extracting the cookie data and merging it into the initial state of the app.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * default state
 */</span>
<span class="token keyword">let</span> state<span class="token punctuation">:</span> IState <span class="token operator">=</span> store<span class="token punctuation">.</span>state<span class="token punctuation">;</span>
state <span class="token operator">=</span> PersistCookieStorage<span class="token punctuation">.</span>getMergedStateFromServerContext <span class="token operator">&lt;</span> IState <span class="token operator">&gt;</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> state<span class="token punctuation">)</span><span class="token punctuation">;</span>
state<span class="token punctuation">.</span>app<span class="token punctuation">.</span>config <span class="token operator">=</span> context<span class="token punctuation">.</span>appConfig<span class="token punctuation">;</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>state<span class="token punctuation">.</span>app <span class="token operator">&amp;&amp;</span> state<span class="token punctuation">.</span>app<span class="token punctuation">.</span>locale<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  context<span class="token punctuation">.</span>acceptLanguage <span class="token operator">=</span> state<span class="token punctuation">.</span>app<span class="token punctuation">.</span>locale<span class="token punctuation">;</span>
  context<span class="token punctuation">.</span>htmlLang <span class="token operator">=</span> state<span class="token punctuation">.</span>app<span class="token punctuation">.</span>locale<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  state<span class="token punctuation">.</span>app<span class="token punctuation">.</span>locale <span class="token operator">=</span> context<span class="token punctuation">.</span>acceptLanguage<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

store<span class="token punctuation">.</span><span class="token function">replaceState</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">Cookie size</p> <p>Please keep in mind that most web servers have a default maximum header size of <strong>4KB</strong> for cookies,
so you should consider just saving necessary data.</p></div> <h2 id="persist-to-localstorage"><a href="#persist-to-localstorage" aria-hidden="true" class="header-anchor">#</a> Persist to LocalStorage</h2> <p>Vuesion includes a LocalStorage adapter for the VueX-persist middleware.</p> <div class="tip custom-block"><p class="custom-block-title">LocalStorage</p> <p>LocalStorage works well for saving mid-sized data, but be aware that it is only available on the <strong>client</strong>.
That means that data you save to it will not be rendered on the server. The DOM will always differ in this case.</p></div> <p>It is already referenced in the file <code>./src/app/store.ts</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> PersistLocalStorage <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@vuesion/addon-vuex-persist/dist/PersistLocalStorage'</span><span class="token punctuation">;</span>

<span class="token operator">...</span>

<span class="token keyword">const</span> beforePersistLocalStorage <span class="token operator">=</span> <span class="token punctuation">(</span>localState<span class="token punctuation">:</span> IState<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token parameter">IState</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">delete</span> localState<span class="token punctuation">.</span>counter<span class="token punctuation">.</span>incrementPending<span class="token punctuation">;</span>
  <span class="token keyword">delete</span> localState<span class="token punctuation">.</span>counter<span class="token punctuation">.</span>decrementPending<span class="token punctuation">;</span>

  <span class="token keyword">return</span> localState<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token operator">...</span>

<span class="token keyword">new</span> <span class="token class-name">PersistLocalStorage</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'counter'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> beforePersistLocalStorage<span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre></div><p>To persist your state to LocalStorage, you have to initialize a
new instance of <code>PersistLocalStorage</code> which takes a list of module names as
the first parameter and a callback to delete state that should not be persisted
to LocalStorage as the second parameter.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/vuesion/docs/edit/master/en/guide/vuex.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/docs/en/guide/cli.html" class="prev">
          Create a new Page
        </a></span> <span class="next"><a href="/docs/en/guide/build.html">
          Production build
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.1d2a10be.js" defer></script><script src="/docs/assets/js/2.bed876bd.js" defer></script><script src="/docs/assets/js/23.1675ef9e.js" defer></script>
  </body>
</html>
